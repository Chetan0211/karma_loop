<div data-controller="home--index" x-init="footer_active_tab = 'home'" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
    <div class="hidden md:block md:col-span-1">
      <div class="sticky top-20">
        <nav class="space-y-1">
          <%= link_to user_profile_path(id: current_user.id), class: "text-[var(--txt-clr-muted)] hover:bg-[var(--background-clr-thick)] hover:text-[var(--txt-clr-strong)] group flex items-center px-3 py-2 text-sm font-medium rounded-md" do %>
            <span class="h-8 w-8 overflow-hidden rounded-full bg-[var(--primary-100)] text-[var(--primary-600)] flex items-center justify-center mr-3">
              <% if current_user.profile_picture.attached? %>
                <%= image_tag url_for(current_user.profile_picture) %>
              <% else %>
                <%= icon(icon: :user_icon, options: {class: "fa-fw"}) %>
              <% end %>
            </span>
            <%= current_user.display_name %>
          <% end %>
          <%= link_to connections_path, class: "text-[var(--txt-clr-muted)] hover:bg-[var(--background-clr-thick)] hover:text-[var(--txt-clr-strong)] group flex items-center px-3 py-2 text-sm font-medium rounded-md" do %>
            <span class="h-8 w-8 overflow-hidden rounded-full bg-[var(--primary-100)] text-[var(--primary-600)] flex items-center justify-center mr-3">
              <i class="fa-solid fa-user-group"></i>
            </span>
            Friends
          <% end %>
          <%= link_to chat_index_path, class: "text-[var(--txt-clr-muted)] hover:bg-[var(--background-clr-thick)] hover:text-[var(--txt-clr-strong)] group flex items-center px-3 py-2 text-sm font-medium rounded-md" do %>
            <span class="h-8 w-8 overflow-hidden rounded-full bg-[var(--primary-100)] text-[var(--primary-600)] flex items-center justify-center mr-3">
              <i class="fa-solid fa-comment-dots"></i>
            </span>
            Chats
          <% end %>
          <a href="#" class="text-[var(--txt-clr-muted)] hover:bg-[var(--background-clr-thick)] hover:text-[var(--txt-clr-strong)] group flex items-center px-3 py-2 text-sm font-medium rounded-md">
            <span class="h-8 w-8 overflow-hidden rounded-full bg-[var(--primary-100)] text-[var(--primary-600)] flex items-center justify-center mr-3">
              <i class="fa-solid fa-users"></i>
            </span>
            Communities
          </a>
          <a href="#" class="text-[var(--txt-clr-muted)] hover:bg-[var(--background-clr-thick)] hover:text-[var(--txt-clr-strong)] group flex items-center px-3 py-2 text-sm font-medium rounded-md">
            <span class="h-8 w-8 overflow-hidden rounded-full bg-[var(--primary-100)] text-[var(--primary-600)] flex items-center justify-center mr-3">
              <i class="fa-solid fa-bookmark"></i>
            </span>
            Saved
          </a>
        </nav>
      </div>
    </div>
    <div class="md:col-span-2 space-y-4">
      <% if @posts.present? %>
        <% @posts.each do |post| %>
          <%= render "shared/post", post: post %>
        <% end %>
      <% else %>
        <div x-transition class="bg-[var(--background-clr-clear)] rounded-md shadow-sm p-8 text-center">
          <div class="max-w-md mx-auto">
            <%= icon(icon: :rocket_icon, options: {class: "fa-3x text-[var(--txt-clr-lite)]"}) %>
            <h2 class="mt-4 text-xl font-semibold text-[var(--txt-clr-thick)]">This page is pretty quiet</h2>
            <p class="mt-2 text-sm text-[var(--txt-clr-muted)]">
              There are no posts here yet. Be the first to share something with the community!
            </p>
            <%= link_to new_post_path,class: "mt-6 inline-flex items-center px-6 py-2 border border-transparent text-[var(--white)] shadow-sm text-sm font-medium rounded-full bg-[var(--primary-600)] hover:bg-[var(--primary-700)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary-500)]" do %>
              <%= icon(icon: :plus_icon, options: {class: "mr-2"}) %> Create Post
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
    <div class="hidden md:block space-y-4">
      <div class="bg-[var(--background-clr-clear)] p-4 rounded-md shadow">
        <h4 class="font-semibold mb-3 border-b pb-2">Community Info</h4>
        <p class="text-sm text-[var(--txt-clr-muted)] mb-2">Welcome to k/communityName! A place to discuss...</p>
        <button class="w-full bg-[var(--primary-600)] hover:bg-[var(--primary-700)] text-[var(--txt-clr-inverted)] text-sm font-bold py-2 px-4 rounded-full transition duration-150 ease-in-out">Join</button>
      </div>
      <div class="bg-[var(--background-clr-clear)] p-4 rounded-md shadow">
        <h4 class="font-semibold mb-3 border-b pb-2">Trending Topics</h4>
        <ul class="space-y-2 text-sm">
          <li><a href="#" class="text-[var(--primary-600)] hover:underline">#topic1</a></li>
          <li><a href="#" class="text-[var(--primary-600)] hover:underline">#very_long_topic_example</a></li>
          <li><a href="#" class="text-[var(--primary-600)] hover:underline">#topic3</a></li>
        </ul>
      </div>
      <div class="bg-[var(--background-clr-clear)] p-4 rounded-md shadow sticky top-20">
        <h4 class="font-semibold mb-3 border-b pb-2">Site Rules</h4>
        <ol class="list-decimal list-inside space-y-1 text-xs text-[var(--txt-clr-muted)]">
          <li>Be respectful.</li>
          <li>No spamming.</li>
          <li>Relevant content only.</li>
        </ol>
      </div>
    </div>
  </div>
</div>
<script>
  function scrollGallery(button, direction) {
      const galleryContainer = button.closest('.relative').querySelector('.overflow-x-auto');
      if (galleryContainer) {
          // Calculate the scroll amount (e.g., width of one image container)
          // Using clientWidth as an approximation for one item's visible width
          const scrollAmount = galleryContainer.clientWidth * 0.85; // Scroll slightly less than full width
          galleryContainer.scrollBy({
              left: scrollAmount * direction,
              behavior: 'smooth' // Smooth scrolling
          });
      }
  }
</script>