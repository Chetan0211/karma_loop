<nav class="bg-white shadow-md sticky top-0 z-40">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <div class="flex-shrink-0">
        <a href="#" class="flex items-center text-purple-600 hover:text-purple-700 transition duration-150 ease-in-out">
          <%= image_tag("logo.png", alt: "K-loop Logo", class: "h-8 w-auto mr-2") %>
          <span class="text-2xl font-bold">k-loop</span>
        </a>
      </div>
      <div class="hidden md:flex flex-grow justify-center px-4">
        <div class="relative w-full max-w-lg">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <%= icon(icon: :search_icon, options:{class:"text-gray-400"}) %>
          </div>
          <input
            id="search"
            name="search"
            class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm transition duration-150 ease-in-out"
            placeholder="Search k-loop..."
            type="search"
          >
          </div>
        </div>
        <div class="hidden md:flex items-center space-x-4">
          <button type="button" class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition duration-150 ease-in-out">
            <%= icon(icon: :plus_icon, options:{class: "text-gray-500 mr-1"}) %>
            Create Post
          </button>
          <button type="button" class="p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
            <span class="sr-only">View notifications</span>
            <%= icon(icon: :bell_icon, options:{class: "text-xl"}) %>
          </button>
          <div x-data="{ open: false }" class="relative">
            <div>
              <button @click="open = !open" type="button" class="bg-white rounded-full flex text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
                <span class="sr-only">Open user menu</span>
                <span class="inline-block h-8 w-8 overflow-hidden rounded-full bg-gray-100">
                  <svg class="h-full w-full text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z" />
                  </svg>
                </span>
              </button>
            </div>
            <div
                            x-show="open"
                            x-transition:enter="transition ease-out duration-100"
                            x-transition:enter-start="transform opacity-0 scale-95"
                            x-transition:enter-end="transform opacity-100 scale-100"
                            x-transition:leave="transition ease-in duration-75"
                            x-transition:leave-start="transform opacity-100 scale-100"
                            x-transition:leave-end="transform opacity-0 scale-95"
                            @click.away="open = false"
                            class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1"
                            style="display: none;" >
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-0">Your Profile</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-1">Settings</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-2">Sign out</a>
            </div>
          </div>
        </div>
        <div class="-mr-2 flex md:hidden">
          <button type="button" class="p-1 mr-2 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
            <span class="sr-only">Search</span>
            <%= icon(icon: :search_icon, options:{class:"text-xl"}) %>
          </button>
          <button type="button" class="bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-purple-500" aria-controls="mobile-menu" aria-expanded="false" id="mobile-menu-button">
            <span class="sr-only">Open main menu</span>
            <%= icon(icon: :search_icon, options:{class:"text-xl block", id:"hamburger-icon"}) %>
          </button>
        </div>
      </div>
    </div>
  </nav>
  <div id="mobile-menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden md:hidden"></div>
  <div id="mobile-menu" class="fixed top-0 right-0 h-full w-64 sm:w-80 bg-white shadow-xl z-50 transform translate-x-full transition-transform duration-300 ease-in-out md:hidden">
    <div class="flex justify-between items-center p-4 border-b border-gray-200">
      <span class="font-semibold text-gray-800">Menu</span>
      <button type="button" class="p-2 text-gray-400 hover:text-gray-600" id="mobile-menu-close-button">
        <span class="sr-only">Close menu</span>
        <%= icon(icon: :close_icon, options: {class: "text-xl"}) %>
      </button>
    </div>
    <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
      <a href="#" class="bg-purple-50 border-purple-500 text-purple-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium" aria-current="page">Home</a>
      <a href="#" class="border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium">Popular</a>
      <a href="#" class="border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium">All</a>
    </div>
    <div class="pt-4 pb-3 border-t border-gray-200">
      <div class="flex items-center px-5">
        <div class="flex-shrink-0">
          <span class="inline-block h-10 w-10 overflow-hidden rounded-full bg-gray-100">
            <%= icon(icon: :user_icon, options: {class: "text-gray-400 text-xl"}) %>
          </span>
        </div>
        <div class="ml-3">
          <div class="text-base font-medium text-gray-800">User Name</div>
          <div class="text-sm font-medium text-gray-500">user@example.com</div>
        </div>
        <button type="button" class="ml-auto bg-white flex-shrink-0 p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
          <span class="sr-only">View notifications</span>
          <i class="fa-regular fa-bell text-xl"></i>
          <%= icon(icon: :bell_icon, options: {class: "text-xl"}) %>
        </button>
      </div>
      <div class="mt-3 px-2 space-y-1">
        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-gray-500 hover:bg-gray-50 hover:text-gray-800">Your Profile</a>
        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-gray-500 hover:bg-gray-50 hover:text-gray-800">Settings</a>
        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-gray-500 hover:bg-gray-50 hover:text-gray-800">Sign out</a>
      </div>
    </div>
  </div>
</nav>
<script>
  const menuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
  const closeButton = document.getElementById('mobile-menu-close-button'); // Get the close button inside the menu

  function openMenu() {
      mobileMenu.classList.remove('translate-x-full'); // Slide in
      mobileMenuOverlay.classList.remove('hidden'); // Show overlay
      document.body.classList.add('overflow-hidden'); // Prevent body scroll
      menuButton.setAttribute('aria-expanded', 'true');
  }

  function closeMenu() {
      mobileMenu.classList.add('translate-x-full'); // Slide out
      mobileMenuOverlay.classList.add('hidden'); // Hide overlay
      document.body.classList.remove('overflow-hidden'); // Allow body scroll
      menuButton.setAttribute('aria-expanded', 'false');
  }

  // Event listener for the hamburger button
  menuButton.addEventListener('click', () => {
      const isExpanded = menuButton.getAttribute('aria-expanded') === 'true';
      if (isExpanded) {
          closeMenu();
      } else {
          openMenu();
      }
  });

  // Event listener for the close button inside the menu
  closeButton.addEventListener('click', closeMenu);

  // Event listener for the overlay (closes menu when clicked)
  mobileMenuOverlay.addEventListener('click', closeMenu);
</script>